schema: '2.0'
stages:
  prepare_datasets:
    cmd: python src/flare_classifier/prepare_datasets.py data/light-curves/generated_1m_cleaned.parquet
      data/light-curves/lc_1M.parquet
    deps:
    - path: data/light-curves/generated_1m_cleaned.parquet
      md5: c5189eff1fbb76d19c27973b2e34a0c0
      size: 508424020
    - path: data/light-curves/lc_1M.parquet
      md5: ad6651a6b602cfdef7e8baa8ed775d1e
      size: 1005283880
    - path: src/flare_classifier/prepare_datasets.py
      md5: de80674dd9057180cc65e410899df414
      size: 1709
    params:
      params.yaml:
        prepare_datasets.seed: 221
        prepare_datasets.test_size: 0.15
        prepare_datasets.train_size: 0.75
    outs:
    - path: data/prepared
      md5: 342dc5e5bfe9e914b9c14952a76054a8.dir
      size: 1143098213
      nfiles: 5
  train_rf:
    cmd: python src/flare_classifier/train_rf.py data/prepared
    deps:
    - path: data/prepared/feature_names.csv
      md5: 096f54a8fffd95fdbc56e763ad69f4f2
      size: 519
    - path: data/prepared/train.parquet
      md5: 0cbb30d5aec4a80bedbbe6f71ee29491
      size: 857880496
    - path: src/flare_classifier/prepare_datasets.py
      md5: de80674dd9057180cc65e410899df414
      size: 1709
    - path: src/flare_classifier/train_rf.py
      md5: be8640f4e9481892491865115bede4ed
      size: 1019
    params:
      params.yaml:
        train_rf.n_estimators: 100
        train_rf.seed: 42
    outs:
    - path: models/random_forest/random_forest.pickle
      md5: ee9778cae72010f901a877f9a0299995
      size: 415725537
      cloud:
        lpc:
          etag: dfe491bf96bdd0a9c524073a8d136240-8
          version_id: 4f260290-3d83-4b06-b2ec-4040147cec58
  train_catboost:
    cmd: python src/flare_classifier/train_catboost.py data/prepared/
    deps:
    - path: data/prepared/feature_names.csv
      md5: 096f54a8fffd95fdbc56e763ad69f4f2
      size: 519
    - path: data/prepared/train.parquet
      md5: 0cbb30d5aec4a80bedbbe6f71ee29491
      size: 857880496
    - path: src/flare_classifier/prepare_datasets.py
      md5: de80674dd9057180cc65e410899df414
      size: 1709
    - path: src/flare_classifier/train_catboost.py
      md5: db858be415f1d143560a7a365a5ff2db
      size: 1579
    params:
      params.yaml:
        train_catboost.depth: 5
        train_catboost.iterations: 10000
        train_catboost.learning_rate: 0.001
        train_catboost.loss_function: Logloss
        train_catboost.seed: 42
    outs:
    - path: models/catboost/catboost.pickle
      md5: 7b76344ef69283cc413f843c85af2b29
      size: 6289760
  train_mlp:
    cmd: python src/flare_classifier/train_mlp.py data/prepared/
    deps:
    - path: data/prepared/feature_names.csv
      md5: 096f54a8fffd95fdbc56e763ad69f4f2
      size: 519
    - path: data/prepared/train.parquet
      md5: 0cbb30d5aec4a80bedbbe6f71ee29491
      size: 857880496
    - path: data/prepared/val.parquet
      md5: 853157ef1e45911a94a6406d2a8916b7
      size: 104140280
    - path: src/flare_classifier/mlp_model.py
      md5: 43587811c5951e16b0052b1c7e7ad3fc
      size: 1497
    - path: src/flare_classifier/prepare_datasets.py
      md5: de80674dd9057180cc65e410899df414
      size: 1709
    - path: src/flare_classifier/train_mlp.py
      md5: 37155e78b4d2ce3334905fa16ae76c4e
      size: 3971
    params:
      params.yaml:
        train_mlp.batch_size: 1024
        train_mlp.lr: 0.001
        train_mlp.num_epochs: 150
    outs:
    - path: models/mlp/mlp.pickle
      md5: 3c5b4f4f15dbcc99e83b43b286ac61c3
      size: 894651
  evaluate_rf:
    cmd: python src/flare_classifier/evaluate_rf.py models/random_forest/random_forest.pickle
      data/prepared/ data/light-curves/real_flares_test.csv
    deps:
    - path: data/light-curves/real_flares_test.csv
      md5: 41549f4174fdd29bfd6d4a1f71d17b6e
      size: 682093
    - path: data/prepared/test.parquet
      md5: f7386628dfff91a5f81fb76595d21d8a
      size: 181075058
    - path: data/prepared/train.parquet
      md5: 0cbb30d5aec4a80bedbbe6f71ee29491
      size: 857880496
    - path: models/random_forest/random_forest.pickle
      md5: ee9778cae72010f901a877f9a0299995
      size: 415725537
    - path: src/flare_classifier/evaluate_rf.py
      md5: 3c617bcdebeaa5b90fd5261569ab73ed
      size: 1897
    - path: src/flare_classifier/metrics.py
      md5: 745d0e9001210e2df95d91f420064c4b
      size: 1572
    - path: src/flare_classifier/train_rf.py
      md5: be8640f4e9481892491865115bede4ed
      size: 1019
    outs:
    - path: metrics/random_forest/test_metrics.json
      md5: 2578bd3a6ab9692dd4f760cf2d1ba931
      size: 136
    - path: metrics/random_forest/train_metrics.json
      md5: 66d9d9daae080490a6d2661175ffed79
      size: 121
  evaluate_catboost:
    cmd: python src/flare_classifier/evaluate_catboost.py models/catboost/catboost.pickle
      data/prepared/ data/light-curves/real_flares_test.csv
    deps:
    - path: data/light-curves/real_flares_test.csv
      md5: 41549f4174fdd29bfd6d4a1f71d17b6e
      size: 682093
    - path: data/prepared/test.parquet
      md5: f7386628dfff91a5f81fb76595d21d8a
      size: 181075058
    - path: data/prepared/train.parquet
      md5: 0cbb30d5aec4a80bedbbe6f71ee29491
      size: 857880496
    - path: models/catboost/catboost.pickle
      md5: 7b76344ef69283cc413f843c85af2b29
      size: 6289760
    - path: src/flare_classifier/evaluate_catboost.py
      md5: 7f3d1be7b0efda3a494915d8d75d294b
      size: 1922
    - path: src/flare_classifier/metrics.py
      md5: 745d0e9001210e2df95d91f420064c4b
      size: 1572
    - path: src/flare_classifier/train_catboost.py
      md5: db858be415f1d143560a7a365a5ff2db
      size: 1579
    outs:
    - path: metrics/catboost/test_metrics.json
      md5: c53bc49528eb275c9f259d731ce27728
      size: 136
    - path: metrics/catboost/train_metrics.json
      md5: 027dc708c2a5d44fb88dff7aaa018438
      size: 136
  evaluate_mlp:
    cmd: python src/flare_classifier/evaluate_mlp.py models/mlp/mlp.pickle data/prepared/
      data/light-curves/real_flares_test.csv
    deps:
    - path: data/light-curves/real_flares_test.csv
      md5: 41549f4174fdd29bfd6d4a1f71d17b6e
      size: 682093
    - path: data/prepared/test.parquet
      md5: f7386628dfff91a5f81fb76595d21d8a
      size: 181075058
    - path: data/prepared/train.parquet
      md5: 0cbb30d5aec4a80bedbbe6f71ee29491
      size: 857880496
    - path: models/mlp/mlp.pickle
      md5: 3c5b4f4f15dbcc99e83b43b286ac61c3
      size: 894651
    - path: src/flare_classifier/evaluate_mlp.py
      md5: 6f795ded6b61bf15ca2c2a61b60b269d
      size: 3192
    - path: src/flare_classifier/metrics.py
      md5: 745d0e9001210e2df95d91f420064c4b
      size: 1572
    - path: src/flare_classifier/train_mlp.py
      md5: 37155e78b4d2ce3334905fa16ae76c4e
      size: 3971
    outs:
    - path: metrics/mlp/test_metrics.json
      md5: 4fe59ea7ae312ceded7184ca5d457eb0
      size: 134
    - path: metrics/mlp/train_metrics.json
      md5: bd6eba342a17806348ffa023afc24680
      size: 136
